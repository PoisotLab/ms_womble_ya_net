<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving
and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
  <front>
    <journal-meta>
      <journal-id/>
      <journal-title-group>
        <journal-title>Earth and Space Science</journal-title>
      </journal-title-group>
      <issn/>
      <publisher>
        <publisher-name/>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Omnomnomnivores</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author">
          <contrib-id contrib-id-type="orcid">0000-0001-6067-1349</contrib-id>
          <name>
            <surname>Strydom</surname>
            <given-names>Tanya</given-names>
          </name>
          <string-name>Tanya Strydom</string-name>
          <email>t.strydom@sheffield.ac.uk</email>
          <role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
          <role vocab="https://credit.niso.org" vocab-term="software" vocab-term-identifier="https://credit.niso.org/contributor-roles/software/">Software</role>
          <role vocab="https://credit.niso.org" vocab-term="visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization/">Visualization</role>
          <xref ref-type="aff" rid="aff-1">a</xref>
        </contrib>
        <contrib contrib-type="author" corresp="yes">
          <contrib-id contrib-id-type="orcid">0000-0002-0735-5184</contrib-id>
          <name>
            <surname>Poisot</surname>
            <given-names>Timothée</given-names>
          </name>
          <string-name>Timothée Poisot</string-name>
          <email>timothee.poisot@umontreal.ca</email>
          <xref ref-type="aff" rid="aff-2">b</xref>
          <xref ref-type="aff" rid="aff-3">c</xref>
          <xref ref-type="corresp" rid="cor-2">*</xref>
        </contrib>
      </contrib-group>
      <aff id="aff-1">
        <institution-wrap>
          <institution>Uum??</institution>
        </institution-wrap>
      </aff>
      <aff id="aff-2">
        <institution-wrap>
          <institution>Université de Montreal</institution>
        </institution-wrap>
      </aff>
      <aff id="aff-3">
        <institution-wrap>
          <institution>Québec Centre for Biodiversity Sciences</institution>
        </institution-wrap>
      </aff>
      <author-notes>
        <corresp id="cor-2">timothee.poisot@umontreal.ca</corresp>
      </author-notes>
      <pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-03-13">
        <year>2024</year>
        <month>3</month>
        <day>13</day>
      </pub-date>
      <history/>
      <abstract>
        <p>TODO</p>
      </abstract>
      <kwd-group kwd-group-type="author">
        <kwd>wombling</kwd>
        <kwd>spatial networks</kwd>
      </kwd-group>
    </article-meta>
  </front>
  <body>
    <sec id="introduction">
      <title>1 Introduction</title>
    </sec>
    <sec id="sec-data-methods">
      <title>2 Data &amp; Methods</title>
      <sec id="metacommunity-model">
        <title>2.1 Metacommunity model</title>
        <p>The model used broadly follows the metacommunity model developed
    by Thompson and Gonzalez
    (<xref alt="2017" rid="ref-thompsonDispersalGovernsReorganization2017" ref-type="bibr">2017</xref>).
    The model
    (<xref alt="Equation 1" rid="eq-metacomm">Equation 1</xref>) itself
    is based on a tritrophic community (‘plants’, ‘herbivores’, and
    ‘carnivores’), and is essentially a collection of modified
    Lotka–Volterra equations, this (broadly) models species abundance as
    a function of interaction strength, environmental effect,
    immigration, and emigration. The metacommunity consists of
    <inline-formula><alternatives><tex-math><![CDATA[S]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>S</mml:mi></mml:math></alternatives></inline-formula>
    species with <inline-formula><alternatives><tex-math><![CDATA[M]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>M</mml:mi></mml:math></alternatives></inline-formula>
    environmental patches in the landscape and looks as follows:</p>
        <p>
          <styled-content id="eq-metacomm">
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
    X_{ij}(t+1)=X_{ij}(t)exp\left[C_{i} + \sum_{k=1}^{S}B_{ik}X_{kj}(t)+A_{ij}(t)\right]+I_{ij}(t)-X_{ij}(t)a_{i}
     \qquad(1)]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>X</mml:mi>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mi>t</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>=</mml:mo>
                    <mml:msub>
                      <mml:mi>X</mml:mi>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mi>t</mml:mi>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mi>e</mml:mi>
                    <mml:mi>x</mml:mi>
                    <mml:mi>p</mml:mi>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">[</mml:mo>
                      <mml:msub>
                        <mml:mi>C</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:munderover>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>S</mml:mi>
                      </mml:munderover>
                      <mml:msub>
                        <mml:mi>B</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:msub>
                        <mml:mi>X</mml:mi>
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:mi>t</mml:mi>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mo>+</mml:mo>
                      <mml:msub>
                        <mml:mi>A</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:mi>t</mml:mi>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mo stretchy="true" form="postfix">]</mml:mo>
                    </mml:mrow>
                    <mml:mo>+</mml:mo>
                    <mml:msub>
                      <mml:mi>I</mml:mi>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mi>t</mml:mi>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>−</mml:mo>
                    <mml:msub>
                      <mml:mi>X</mml:mi>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mi>t</mml:mi>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:msub>
                      <mml:mi>a</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                    <mml:mspace width="2.0em"/>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </styled-content>
        </p>
        <p>Where <inline-formula><alternatives><tex-math><![CDATA[X_{ij}(t)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
    is the abundance of species <inline-formula><alternatives><tex-math><![CDATA[i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>
    in patch <inline-formula><alternatives><tex-math><![CDATA[j]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>
    at time <inline-formula><alternatives><tex-math><![CDATA[t]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>t</mml:mi></mml:math></alternatives></inline-formula>.
    <inline-formula><alternatives><tex-math><![CDATA[C_i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
    is its intrinsic rate of increase (which we have set to 0.1 for
    ‘plants’ and -0.001 for ‘herbivores’ and ‘carnivores’).
    <inline-formula><alternatives><tex-math><![CDATA[B_{ik}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
    is the per capita effect of species <inline-formula><alternatives><tex-math><![CDATA[k]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>
    on species <inline-formula><alternatives><tex-math><![CDATA[i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>.
    The exact interaction strength for each species pair is determined
    by the trophic level of each species and is drawn from a uniform
    distribution. The ranges for each combination of species pairs
    listed in
    <xref alt="Table 1" rid="tbl-interaction_strength">Table 1</xref>,
    the values that are drawn from the uniform distribution are then
    scaled by dividing by <inline-formula><alternatives><tex-math><![CDATA[0.33S]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mn>0.33</mml:mn><mml:mi>S</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
    to yield the final interaction strength for each interacting
    pair.</p>
        <fig id="tbl-interaction_strength">
          <caption>
            <p>Table 1: Intervals used for the uniform distribution
      from which interaction strengths values are drawn from for the
      different types of species pair interactions. Note this is
      represent the effect of species type 1 on species type 2
      <italic>i.e.,</italic> herbivore-plant represents the effect of a
      herbivore species on a plant species</p>
          </caption>
          <table-wrap>
            <table>
              <thead>
                <tr>
                  <th>Interacting pair</th>
                  <th align="center">Range of uniform distribution</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Plant-plant</td>
                  <td align="center">-1.0 – 0.00</td>
                </tr>
                <tr>
                  <td>Plant-herbivore</td>
                  <td align="center">0.0 – 0.10</td>
                </tr>
                <tr>
                  <td>Plant-carnivore</td>
                  <td align="center">0.0</td>
                </tr>
                <tr>
                  <td>Herbivore-plant</td>
                  <td align="center">-0.3 – 0.00</td>
                </tr>
                <tr>
                  <td>Herbivore-herbivore</td>
                  <td align="center">-0.2 – -0.15</td>
                </tr>
                <tr>
                  <td>Herbivore-carnivore</td>
                  <td align="center">0.0 – 0.08</td>
                </tr>
                <tr>
                  <td>Carnivore-plant</td>
                  <td align="center">0.0</td>
                </tr>
                <tr>
                  <td>Carnivore-herbivore</td>
                  <td align="center">-0.1 – 0.00</td>
                </tr>
                <tr>
                  <td>Carnivore-carnivore</td>
                  <td align="center">-0.1 – 0.00</td>
                </tr>
              </tbody>
            </table>
          </table-wrap>
        </fig>
        <p><inline-formula><alternatives><tex-math><![CDATA[A_{ij}(t)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
    is the effect of the environment in patch
    <inline-formula><alternatives><tex-math><![CDATA[j]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>
    on species <inline-formula><alternatives><tex-math><![CDATA[i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>
    at time <inline-formula><alternatives><tex-math><![CDATA[t]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>t</mml:mi></mml:math></alternatives></inline-formula>.
    Essentially this will set the effect of the environment to zero when
    it is at the optimum of the species and can be further expanded as
    follows:</p>
        <p>
          <styled-content id="eq-metacomm_env">
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
    A_{ij}(t)=\left(h\times\frac{1}{\sigma\sqrt{2\pi}}\right)\times\left(\text{exp}\left[-\frac{(E_{j}(t)-H_{i})^2}{{2\sigma}^2}\right]-1\right)
     \qquad(2)]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>A</mml:mi>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mi>t</mml:mi>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>=</mml:mo>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mi>h</mml:mi>
                      <mml:mo>×</mml:mo>
                      <mml:mfrac>
                        <mml:mn>1</mml:mn>
                        <mml:mrow>
                          <mml:mi>σ</mml:mi>
                          <mml:msqrt>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                              <mml:mi>π</mml:mi>
                            </mml:mrow>
                          </mml:msqrt>
                        </mml:mrow>
                      </mml:mfrac>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>×</mml:mo>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mtext mathvariant="normal">exp</mml:mtext>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">[</mml:mo>
                        <mml:mo>−</mml:mo>
                        <mml:mfrac>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mo stretchy="true" form="prefix">(</mml:mo>
                              <mml:msub>
                                <mml:mi>E</mml:mi>
                                <mml:mi>j</mml:mi>
                              </mml:msub>
                              <mml:mrow>
                                <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                <mml:mi>t</mml:mi>
                                <mml:mo stretchy="true" form="postfix">)</mml:mo>
                              </mml:mrow>
                              <mml:mo>−</mml:mo>
                              <mml:msub>
                                <mml:mi>H</mml:mi>
                                <mml:mi>i</mml:mi>
                              </mml:msub>
                              <mml:mo stretchy="true" form="postfix">)</mml:mo>
                            </mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:msup>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                              <mml:mi>σ</mml:mi>
                            </mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:msup>
                        </mml:mfrac>
                        <mml:mo stretchy="true" form="postfix">]</mml:mo>
                      </mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mspace width="2.0em"/>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </styled-content>
        </p>
        <p>Where the species environmental optima
    (<inline-formula><alternatives><tex-math><![CDATA[H_i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>H</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>)
    are evenly distributed across the entire range of environmental
    conditions for each trophic level, meaning that species from
    different trophic levels will be at, or near the same environmental
    optima. <inline-formula><alternatives><tex-math><![CDATA[h]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>h</mml:mi></mml:math></alternatives></inline-formula>
    is a scaling parameter (set to <bold>50</bold>),
    <inline-formula><alternatives><tex-math><![CDATA[E_j(t)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
    is the environment in patch <inline-formula><alternatives><tex-math><![CDATA[j]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>
    at time <inline-formula><alternatives><tex-math><![CDATA[t]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>t</mml:mi></mml:math></alternatives></inline-formula>
    and <inline-formula><alternatives><tex-math><![CDATA[\sigma]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>σ</mml:mi></mml:math></alternatives></inline-formula>
    is the standard deviation (set to <bold>50</bold>).</p>
        <p><inline-formula><alternatives><tex-math><![CDATA[I_{ij}(t)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
    is the abundance of species <inline-formula><alternatives><tex-math><![CDATA[i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>
    immigrating to patch <inline-formula><alternatives><tex-math><![CDATA[j]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>
    at time <inline-formula><alternatives><tex-math><![CDATA[t]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>t</mml:mi></mml:math></alternatives></inline-formula>
    and can be expanded as follows:</p>
        <p>
          <styled-content id="eq-metacomm_imm">
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
    I_{ij}(t)=\sum_{l=j}^{M}a_iX_{il}(t)exp(-Ld_{jl})
     \qquad(3)]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>I</mml:mi>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mi>t</mml:mi>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>=</mml:mo>
                    <mml:munderover>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                      <mml:mi>M</mml:mi>
                    </mml:munderover>
                    <mml:msub>
                      <mml:mi>a</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                    <mml:msub>
                      <mml:mi>X</mml:mi>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mi>t</mml:mi>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mi>e</mml:mi>
                    <mml:mi>x</mml:mi>
                    <mml:mi>p</mml:mi>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mo>−</mml:mo>
                      <mml:mi>L</mml:mi>
                      <mml:msub>
                        <mml:mi>d</mml:mi>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mi>l</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mspace width="2.0em"/>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mn>3</mml:mn>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </styled-content>
        </p>
        <p>Where <inline-formula><alternatives><tex-math><![CDATA[ai]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
    is the proportion of the population of species
    <inline-formula><alternatives><tex-math><![CDATA[i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>
    that disperses at each time step, the dispersal rate is drawn from a
    normal distribution (<inline-formula><alternatives><tex-math><![CDATA[\mu]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>μ</mml:mi></mml:math></alternatives></inline-formula>
    = 0.1, <inline-formula><alternatives><tex-math><![CDATA[\sigma]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>σ</mml:mi></mml:math></alternatives></inline-formula>
    = 0.025) for each species. The abundance of immigrants to patch
    <inline-formula><alternatives><tex-math><![CDATA[j]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>
    from all other patches is governed by where
    <inline-formula><alternatives><tex-math><![CDATA[d_{jl}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
    is the geographic distance between patches
    <inline-formula><alternatives><tex-math><![CDATA[j]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>
    and <inline-formula><alternatives><tex-math><![CDATA[l]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>l</mml:mi></mml:math></alternatives></inline-formula>,
    and <inline-formula><alternatives><tex-math><![CDATA[L]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>L</mml:mi></mml:math></alternatives></inline-formula>
    (the strength of the exponential decrease in dispersal with
    distance), which is also drawn from a normal distribution for each
    species. The parameters used for <inline-formula><alternatives><tex-math><![CDATA[L]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>L</mml:mi></mml:math></alternatives></inline-formula>
    are trophic level dependant and are show in
    <xref alt="Table 2" rid="tbl-interaction_decay">Table 2</xref></p>
        <fig id="tbl-interaction_decay">
          <caption>
            <p>Table 2: Parameters for the normal distributions used
      to determine the dispersal decay (<inline-formula><alternatives><tex-math><![CDATA[L]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>L</mml:mi></mml:math></alternatives></inline-formula>)
      for each species depending on its trophic level.</p>
          </caption>
          <table-wrap>
            <table>
              <thead>
                <tr>
                  <th>Trophic level</th>
                  <th align="center">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[\mu]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:mi>μ</mml:mi>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </th>
                  <th align="center">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[\sigma]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:mi>σ</mml:mi>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Plant</td>
                  <td align="center">0.3</td>
                  <td align="center">0.075</td>
                </tr>
                <tr>
                  <td>Herbivore</td>
                  <td align="center">0.2</td>
                  <td align="center">0.050</td>
                </tr>
                <tr>
                  <td>Carnivore</td>
                  <td align="center">0.1</td>
                  <td align="center">0.025</td>
                </tr>
              </tbody>
            </table>
          </table-wrap>
        </fig>
      </sec>
      <sec id="generating-networks">
        <title>2.2 Generating networks</title>
        <p>In order to create a final community state the species are
    allowed to persist for a total of 2000 generations. These
    generations are broken down into three ‘phases’ the first is the
    ‘proofing’ phase where the environment is uniform throughout the
    landscape (meaning that all species are at their environmental
    optimum) for 500 generations. After this the environment is ‘heated’
    incrementally until it reaches its ‘final state’, the environmental
    optimum of each species is also adjusted as the environmental values
    begin to change. This occurs over a period of 1 000 generations. The
    landscape is then held stable for a further 500 generations until an
    equilibrium is reached. The final state of the landscape is
    predetermined and is defined by the diamond-square algorithm (this
    produces fractals with variable spatial autocorrelation) which is
    generated using <monospace>NeutralLandscapes.jl</monospace>
    (<xref alt="Catchen 2023" rid="ref-catchenEcoJuliaNeutralLandscapesJl2023" ref-type="bibr">Catchen
    2023</xref>), here we vary the degree of landscape heterogeneity by
    <bold>TODO</bold>.</p>
        <fig id="tbl-model_params">
          <caption>
            <p>Table 3: Starting parameters for the
      model.</p>
          </caption>
          <table-wrap>
            <table>
              <thead>
                <tr>
                  <th>Parameter</th>
                  <th align="center">Value</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[S]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:mi>S</mml:mi>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="center">100</td>
                </tr>
                <tr>
                  <td>
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[M]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:mi>M</mml:mi>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="center">26*26</td>
                </tr>
                <tr>
                  <td>
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[E_{initial}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>E</mml:mi>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mi>n</mml:mi>
                              <mml:mi>i</mml:mi>
                              <mml:mi>t</mml:mi>
                              <mml:mi>i</mml:mi>
                              <mml:mi>a</mml:mi>
                              <mml:mi>l</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="center">40</td>
                </tr>
                <tr>
                  <td>
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[A_{initial}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>A</mml:mi>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mi>n</mml:mi>
                              <mml:mi>i</mml:mi>
                              <mml:mi>t</mml:mi>
                              <mml:mi>i</mml:mi>
                              <mml:mi>a</mml:mi>
                              <mml:mi>l</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="center">0.01</td>
                </tr>
              </tbody>
            </table>
          </table-wrap>
        </fig>
      </sec>
      <sec id="spatial-wombling">
        <title>2.3 Spatial wombling</title>
        <p>Broadly speaking spatial wombling is an edge-detection algorithm
    which traverses a geographic area and defines this area in terms of
    the rate (<inline-formula><alternatives><tex-math><![CDATA[m]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>m</mml:mi></mml:math></alternatives></inline-formula>)
    and corresponding direction (<inline-formula><alternatives><tex-math><![CDATA[\theta]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>θ</mml:mi></mml:math></alternatives></inline-formula>)
    of change. This is done by using first-order partial derivative
    (<inline-formula><alternatives><tex-math><![CDATA[\partial]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>∂</mml:mi></mml:math></alternatives></inline-formula>)
    of the ‘curvature’ of the landscape as described by
    <inline-formula><alternatives><tex-math><![CDATA[f(x,y)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
    (see <xref alt="Equation 4" rid="eq-womble">Equation 4</xref>). This
    essentially gives an indication how steep the gradient
    (<inline-formula><alternatives><tex-math><![CDATA[m]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>m</mml:mi></mml:math></alternatives></inline-formula>)
    is between neighbouring cells as well as the direction
    (<inline-formula><alternatives><tex-math><![CDATA[\theta]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>θ</mml:mi></mml:math></alternatives></inline-formula>)
    of the slope.</p>
        <p>
          <styled-content id="eq-womble">
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
    m = \sqrt{\frac{\partial f(x,y)}{\partial x}^2 + \frac{\partial f(x,y)}{\partial y}^2}
     \qquad(4)]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:msqrt>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:mi>∂</mml:mi>
                              <mml:mi>f</mml:mi>
                              <mml:mrow>
                                <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                <mml:mi>x</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi>y</mml:mi>
                                <mml:mo stretchy="true" form="postfix">)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>∂</mml:mi>
                              <mml:mi>x</mml:mi>
                            </mml:mrow>
                          </mml:mfrac>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                        <mml:mo>+</mml:mo>
                        <mml:msup>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:mi>∂</mml:mi>
                              <mml:mi>f</mml:mi>
                              <mml:mrow>
                                <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                <mml:mi>x</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi>y</mml:mi>
                                <mml:mo stretchy="true" form="postfix">)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>∂</mml:mi>
                              <mml:mi>y</mml:mi>
                            </mml:mrow>
                          </mml:mfrac>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                      </mml:mrow>
                    </mml:msqrt>
                    <mml:mspace width="2.0em"/>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mn>4</mml:mn>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </styled-content>
        </p>
        <p>The spatial wombling analyses were done using
    <monospace>SpatialBoundaries.jl</monospace>
    (<xref alt="Strydom and Poisot 2023" rid="ref-strydomSpatialBoundariesJlEdge2023" ref-type="bibr">Strydom
    and Poisot 2023</xref>). The documentation provides a more detailed
    breakdown of the underlying methodology.</p>
      </sec>
    </sec>
    <sec id="conclusion">
      <title>3 Conclusion</title>
    </sec>
  </body>
  <back>
    <ref-list>
      <title>References</title>
      <ref id="ref-catchenEcoJuliaNeutralLandscapesJl2023">
        <element-citation>
          <person-group person-group-type="author">
            <name>
              <surname>Catchen</surname>
              <given-names>Michael D.</given-names>
            </name>
          </person-group>
          <article-title>EcoJulia/NeutralLandscapes.jl</article-title>
          <publisher-name>EcoJulia</publisher-name>
          <year iso-8601-date="2023-12">2023</year>
          <month>12</month>
          <date-in-citation content-type="access-date">
            <year iso-8601-date="2024-03-13">2024</year>
            <month>03</month>
            <day>13</day>
          </date-in-citation>
        </element-citation>
      </ref>
      <ref id="ref-strydomSpatialBoundariesJlEdge2023">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name>
              <surname>Strydom</surname>
              <given-names>Tanya</given-names>
            </name>
            <name>
              <surname>Poisot</surname>
              <given-names>Timothée</given-names>
            </name>
          </person-group>
          <article-title>SpatialBoundaries.jl: Edge detection using spatial wombling</article-title>
          <source>Ecography</source>
          <year iso-8601-date="2023">2023</year>
          <date-in-citation content-type="access-date">
            <year iso-8601-date="2024-02-01">2024</year>
            <month>02</month>
            <day>01</day>
          </date-in-citation>
          <volume>2023</volume>
          <issue>5</issue>
          <issn>1600-0587</issn>
          <pub-id pub-id-type="doi">10.1111/ecog.06609</pub-id>
          <fpage>e06609</fpage>
          <lpage/>
        </element-citation>
      </ref>
      <ref id="ref-thompsonDispersalGovernsReorganization2017">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name>
              <surname>Thompson</surname>
              <given-names>Patrick L.</given-names>
            </name>
            <name>
              <surname>Gonzalez</surname>
              <given-names>Andrew</given-names>
            </name>
          </person-group>
          <article-title>Dispersal governs the reorganization of ecological networks under environmental change</article-title>
          <source>Nature Ecology &amp; Evolution</source>
          <year iso-8601-date="2017-05">2017</year>
          <month>05</month>
          <date-in-citation content-type="access-date">
            <year iso-8601-date="2017-05-09">2017</year>
            <month>05</month>
            <day>09</day>
          </date-in-citation>
          <volume>1</volume>
          <issue>6</issue>
          <issn>2397-334X</issn>
          <pub-id pub-id-type="doi">10.1038/s41559-017-0162</pub-id>
          <fpage>0162</fpage>
          <lpage/>
        </element-citation>
      </ref>
    </ref-list>
  </back>
</article>
