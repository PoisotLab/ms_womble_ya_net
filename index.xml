<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving
and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">

<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">

<front>
<journal-meta>
<journal-id></journal-id>

<journal-title-group>
<journal-title>Earth and Space Science</journal-title>
</journal-title-group>
<issn></issn>

<publisher>
<publisher-name></publisher-name>
</publisher>
</journal-meta>


<article-meta>


<title-group>
<article-title>Omnomnomnivores</article-title>
</title-group>

<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0001-6067-1349</contrib-id>
<name>
<surname>Strydom</surname>
<given-names>Tanya</given-names>
</name>
<string-name>Tanya Strydom</string-name>

<email>t.strydom@sheffield.ac.uk</email>
<role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
<role vocab="https://credit.niso.org" vocab-term="project
administration" vocab-term-identifier="https://credit.niso.org/contributor-roles/project-administration/">Project
administration</role>
<role vocab="https://credit.niso.org" vocab-term="software" vocab-term-identifier="https://credit.niso.org/contributor-roles/software/">Software</role>
<role vocab="https://credit.niso.org" vocab-term="visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization/">Visualization</role>
<xref ref-type="aff" rid="aff-1">a</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">0000-0002-0735-5184</contrib-id>
<name>
<surname>Poisot</surname>
<given-names>Timothée</given-names>
</name>
<string-name>Timothée Poisot</string-name>

<email>timothee.poisot@umontreal.ca</email>
<xref ref-type="aff" rid="aff-2">b</xref>
<xref ref-type="aff" rid="aff-3">c</xref>
<xref ref-type="corresp" rid="cor-2">&#x002A;</xref>
</contrib>
</contrib-group>
<aff id="aff-1">
<institution-wrap>
<institution>Curvenote</institution>
</institution-wrap>







</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Université de Montreal</institution>
</institution-wrap>







</aff>
<aff id="aff-3">
<institution-wrap>
<institution>Québec Centre for Biodiversity Sciences</institution>
</institution-wrap>







</aff>
<author-notes>
<corresp id="cor-2">timothee.poisot@umontreal.ca</corresp>
</author-notes>

<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-02-05">
<year>2024</year>
<month>2</month>
<day>5</day>
</pub-date>







<history></history>


<abstract>
<p>In September 2021, a significant jump in seismic activity on the
island of La Palma (Canary Islands, Spain) signaled the start of a
volcanic crisis that still continues at the time of writing. Earthquake
data is continually collected and published by the Instituto Geográphico
Nacional (IGN). …</p>
</abstract>
<kwd-group kwd-group-type="author">
<kwd>wombling</kwd>
<kwd>spatial networks</kwd>
</kwd-group>




</article-meta>

</front>

<body>
<sec id="introduction">
  <title>1 Introduction</title>
</sec>
<sec id="sec-data-methods">
  <title>2 Data &amp; Methods</title>
  <sec id="metacommunity-model">
    <title>2.1 Metacommunity model</title>
    <p>The metacommunity model developed by
    (<xref alt="thompsonDispersalGovernsReorganization2017a?" rid="ref-thompsonDispersalGovernsReorganization2017a" ref-type="bibr"><bold>thompsonDispersalGovernsReorganization2017a?</bold></xref>)
    is a good starting point to use for this ‘case study’ as it allows
    us some flexibility with how we want to parameterise the system. The
    model (<xref alt="Equation 1" rid="eq-metacomm">Equation 1</xref>)
    itself is based on a tritrophic community (‘plants’, ‘herbivores’,
    and ‘carnivores’) and is a collection of modified Lotka–Volterra
    equations and (broadly) models species abundance as a function of
    interaction strength, environmental effect, immigration, and
    emigration. The metacommunity consists of
    <inline-formula><alternatives>
    <tex-math><![CDATA[S]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>S</mml:mi></mml:math></alternatives></inline-formula>
    species with <inline-formula><alternatives>
    <tex-math><![CDATA[M]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>M</mml:mi></mml:math></alternatives></inline-formula>
    environmental patches and looks as follows:</p>
    <p><styled-content id="eq-metacomm"><disp-formula><alternatives>
    <tex-math><![CDATA[
    X_{ij}(t+1)=X_{ij}(t)exp\left[C_{i} + \sum_{k=1}^{S}B_{ik}X_{kj}(t)+A_{ij}(t)\right]+I_{ij}(t)-X_{ij}(t)a_{i}
     \qquad(1)]]></tex-math>
    <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:munderover><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="2.0em"></mml:mspace><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></styled-content></p>
    <p>Where <inline-formula><alternatives>
    <tex-math><![CDATA[X_{ij}(t)]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
    is the abundance of species <inline-formula><alternatives>
    <tex-math><![CDATA[i]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>
    in patch <inline-formula><alternatives>
    <tex-math><![CDATA[j]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>
    at time <inline-formula><alternatives>
    <tex-math><![CDATA[t]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>t</mml:mi></mml:math></alternatives></inline-formula>.
    <inline-formula><alternatives>
    <tex-math><![CDATA[C_i]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
    is its intrinsic rate of increase (which we have set to 0.1 for
    ‘plants’ and -0.01 for ‘herbivores’ and ‘carnivores’).
    <inline-formula><alternatives>
    <tex-math><![CDATA[B_{ik}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
    is the per capita effect of species <inline-formula><alternatives>
    <tex-math><![CDATA[k]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>
    on species <inline-formula><alternatives>
    <tex-math><![CDATA[i]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>.
    The exact interaction strength for each species pair is drawn from a
    uniform distribution with the parameters for the interaction pairs
    listed in
    <xref alt="Table 1" rid="tbl-interaction_strength">Table 1</xref>,
    the values drawn from the uniform distribution are scaled by
    dividing by <inline-formula><alternatives>
    <tex-math><![CDATA[0.33S]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>0.33</mml:mn><mml:mi>S</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
    to yield the final interaction strength for each interacting
    pair.</p>
    <fig id="tbl-interaction_strength">
      <caption><p>Table 1: Intervals used for the uniform distribution
      from which interaction strengths values are drawn from for the
      different types of species pair interactions. Note this is
      represent the effect of species type 1 on species type 2
      <italic>i.e.,</italic> herbivore-plant represents the effect of a
      herbivore species on a plant species</p></caption>
      <table-wrap>
        <table>
          <thead>
            <tr>
              <th>Interacting pair</th>
              <th>Range of uniform distribution</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Plant-plant</td>
              <td>-1 – 0</td>
            </tr>
            <tr>
              <td>Plant-herbivore</td>
              <td>0 – 0.1</td>
            </tr>
            <tr>
              <td>Plant-carnivore</td>
              <td>0</td>
            </tr>
            <tr>
              <td>Herbivore-plant</td>
              <td>-0.3 – 0</td>
            </tr>
            <tr>
              <td>Herbivore-herbivore</td>
              <td>-0.2– -0.15</td>
            </tr>
            <tr>
              <td>Herbivore-carnivore</td>
              <td>0 – 0.08</td>
            </tr>
            <tr>
              <td>Carnivore-plant</td>
              <td>0</td>
            </tr>
            <tr>
              <td>Carnivore-herbivore</td>
              <td>-0.1 – 0</td>
            </tr>
            <tr>
              <td>Carnivore-carnivore</td>
              <td>-0.1 – 0</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </fig>
    <p><inline-formula><alternatives>
    <tex-math><![CDATA[A_{ij}(t)]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
    is the effect of the environment in patch
    <inline-formula><alternatives>
    <tex-math><![CDATA[j]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>
    on species <inline-formula><alternatives>
    <tex-math><![CDATA[i]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>
    at time <inline-formula><alternatives>
    <tex-math><![CDATA[t]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>t</mml:mi></mml:math></alternatives></inline-formula>
    and can be further expanded as follows:</p>
    <p><styled-content id="eq-metacomm_env"><disp-formula><alternatives>
    <tex-math><![CDATA[
    A_{ij}(t)=h\left(exp-\frac{(E_{j}(t)-H_{i})^2}{2\sigma^2}-1\right)
     \qquad(2)]]></tex-math>
    <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>h</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mspace width="2.0em"></mml:mspace><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></styled-content></p>
    <p>Species environmental optima (<inline-formula><alternatives>
    <tex-math><![CDATA[H_i]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>H</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>)
    are evenly distributed across the entire range of environmental
    conditions for each trophic level, meaning that species from
    different trophic levels will be at, or near the same environmental
    optima. <inline-formula><alternatives>
    <tex-math><![CDATA[h]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>h</mml:mi></mml:math></alternatives></inline-formula>
    is a scaling parameter (set to 300), <inline-formula><alternatives>
    <tex-math><![CDATA[E_j(t)]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
    is the environment in patch <inline-formula><alternatives>
    <tex-math><![CDATA[j]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>
    at time <inline-formula><alternatives>
    <tex-math><![CDATA[t]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>t</mml:mi></mml:math></alternatives></inline-formula>
    and <inline-formula><alternatives>
    <tex-math><![CDATA[\sigma]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>σ</mml:mi></mml:math></alternatives></inline-formula>
    is the standard deviation (set to 50).</p>
    <p><inline-formula><alternatives>
    <tex-math><![CDATA[I_{ij}(t)]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
    is the abundance of species <inline-formula><alternatives>
    <tex-math><![CDATA[i]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>
    immigrating to patch <inline-formula><alternatives>
    <tex-math><![CDATA[j]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>
    at time <inline-formula><alternatives>
    <tex-math><![CDATA[t]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>t</mml:mi></mml:math></alternatives></inline-formula>
    and can be expanded as follows:</p>
    <p><styled-content id="eq-metacomm_imm"><disp-formula><alternatives>
    <tex-math><![CDATA[
    I_{ij}(t)=\sum_{l=j}^{M}a_iX_{il}(t)exp(-Ld_{jl})
     \qquad(3)]]></tex-math>
    <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mo>−</mml:mo><mml:mi>L</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mspace width="2.0em"></mml:mspace><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></styled-content></p>
    <p>Where <inline-formula><alternatives>
    <tex-math><![CDATA[ai]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
    is the proportion of the population of species
    <inline-formula><alternatives>
    <tex-math><![CDATA[i]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>
    that disperses at each time step, the dispersal rate is drawn from a
    normal distribution (<inline-formula><alternatives>
    <tex-math><![CDATA[\mu]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>μ</mml:mi></mml:math></alternatives></inline-formula>
    = 0.1, <inline-formula><alternatives>
    <tex-math><![CDATA[\sigma]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>σ</mml:mi></mml:math></alternatives></inline-formula>
    = 0.025) for each species. The abundance of immigrants to patch
    <inline-formula><alternatives>
    <tex-math><![CDATA[j]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>
    from all other patches is governed by where
    <inline-formula><alternatives>
    <tex-math><![CDATA[d_{jl}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
    is the geographic distance between patches
    <inline-formula><alternatives>
    <tex-math><![CDATA[j]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>
    and <inline-formula><alternatives>
    <tex-math><![CDATA[l]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>l</mml:mi></mml:math></alternatives></inline-formula>,
    and <inline-formula><alternatives>
    <tex-math><![CDATA[L]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>L</mml:mi></mml:math></alternatives></inline-formula>
    (the strength of the exponential decrease in dispersal with
    distance), which is also drawn from a normal distribution for each
    species. The parameters used for <inline-formula><alternatives>
    <tex-math><![CDATA[L]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>L</mml:mi></mml:math></alternatives></inline-formula>
    are trophic level dependant and are show in
    <xref alt="Table 2" rid="tbl-interaction_decay">Table 2</xref></p>
    <fig id="tbl-interaction_decay">
      <caption><p>Table 2: Parameters for the normal distributions used
      to determine the dispersal decay (<inline-formula><alternatives>
      <tex-math><![CDATA[L]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>L</mml:mi></mml:math></alternatives></inline-formula>)
      for each species depending on its trophic level.</p></caption>
      <table-wrap>
        <table>
          <thead>
            <tr>
              <th>Trophic level</th>
              <th><inline-formula><alternatives>
              <tex-math><![CDATA[\mu]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>μ</mml:mi></mml:math></alternatives></inline-formula></th>
              <th><inline-formula><alternatives>
              <tex-math><![CDATA[\sigma]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>σ</mml:mi></mml:math></alternatives></inline-formula></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Plant</td>
              <td>0.3</td>
              <td>0.075</td>
            </tr>
            <tr>
              <td>Herbivore</td>
              <td>0.2</td>
              <td>0.05</td>
            </tr>
            <tr>
              <td>Carnivore</td>
              <td>0.1</td>
              <td>0.025</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </fig>
  </sec>
  <sec id="generating-networks">
    <title>2.2 Generating networks</title>
    <p>More info on the baking process and the various connectivity
    stuff and whatnot</p>
  </sec>
  <sec id="spatial-wombling">
    <title>2.3 Spatial wombling</title>
    <p>Broadly speaking spatial wombling is an edge-detection algorithm
    which traverses a geographic area and defines this area in terms of
    the rate (<inline-formula><alternatives>
    <tex-math><![CDATA[m]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>m</mml:mi></mml:math></alternatives></inline-formula>)
    and corresponding direction (<inline-formula><alternatives>
    <tex-math><![CDATA[\theta]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>θ</mml:mi></mml:math></alternatives></inline-formula>)
    of change. This is done by using first-order partial derivative
    (<inline-formula><alternatives>
    <tex-math><![CDATA[\partial]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>∂</mml:mi></mml:math></alternatives></inline-formula>)
    of the ‘curvature’ of the landscape as described by
    <inline-formula><alternatives>
    <tex-math><![CDATA[f(x,y)]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
    (see <xref alt="Equation 4" rid="eq-womble">Equation 4</xref>). This
    essentially gives an indiaction how steep the gradient
    (<inline-formula><alternatives>
    <tex-math><![CDATA[m]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>m</mml:mi></mml:math></alternatives></inline-formula>)
    is between neighbouring cells as well as the direction
    (<inline-formula><alternatives>
    <tex-math><![CDATA[\theta]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>θ</mml:mi></mml:math></alternatives></inline-formula>)
    of the slope.</p>
    <p><styled-content id="eq-womble"><disp-formula><alternatives>
    <tex-math><![CDATA[
    m = \sqrt{\frac{\partial f(x,y)}{\partial x}^2 + \frac{\partial f(x,y)}{\partial y}^2}
     \qquad(4)]]></tex-math>
    <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:mfrac><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:mspace width="2.0em"></mml:mspace><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></styled-content></p>
    <p>The spatial wombling analyses were done using
    <monospace>SpatialBoundaries.jl</monospace>
    (<xref alt="strydomSpatialBoundariesJlEdge2023?" rid="ref-strydomSpatialBoundariesJlEdge2023" ref-type="bibr"><bold>strydomSpatialBoundariesJlEdge2023?</bold></xref>).
    The docuemntation provides a more detailed breakdown of the
    underlying methodology.</p>
  </sec>
</sec>
<sec id="conclusion">
  <title>3 Conclusion</title>
</sec>
<sec id="references">
  <title>References</title>
</sec>
</body>

<back>
</back>

<sub-article article-type="notebook" id="nb-4-nb-1">
<front-stub>
<title-group>
<article-title>Data Screening</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0002-0760-5497</contrib-id>
<name>
<surname>Purves</surname>
<given-names>Steve</given-names>
</name>
<string-name>Steve Purves</string-name>

</contrib>
<contrib contrib-type="author">
<name>
<surname>Wickham</surname>
<given-names>Charlotte</given-names>
</name>
<string-name>Charlotte Wickham</string-name>

<xref ref-type="author-note" rid="auth-note-2-nb-1">2</xref>
</contrib>
</contrib-group>
<author-notes>
<fn id="auth-note-2-nb-1" fn-type="author-note" symbol="2">Edited original
notebook by Steve Purves</fn>
</author-notes>
</front-stub>

<body>
<sec id="cell-43daa9a5-nb-1" specific-use="notebook-code">
<preformat>import pandas as pd
import matplotlib.pyplot as plt</preformat>
</sec>
<sec id="cell-25be6d6d-nb-1" specific-use="notebook-content">
<p>Import <monospace>la-palma.csv</monospace> - a clean subset of
<ext-link ext-link-type="uri" xlink:href="https://github.com/Notebooks-Now/submission-quarto-full/blob/main/data/catalogoComunSV_1663233588717.csv"><monospace>catalogoComunSV_1663233588717.csv</monospace></ext-link>:</p>
</sec>
<sec id="cell-7e7b2b9e-nb-1" specific-use="notebook-code">
<preformat>df = pd.read_csv('la-palma.csv')
df['DateTime'] = pd.to_datetime(df['DateTime'])
df = df.sort_values(by=['DateTime'], ascending=True)
df.head()</preformat>
<sec id="cell-7e7b2b9e-output-0-nb-1" specific-use="notebook-output">
<table-wrap>
  <table border="1">
    <thead>
      <tr style="text-align: right;">
        <th></th>
        <th>Longitude</th>
        <th>Latitude</th>
        <th>Depth(km)</th>
        <th>Magnitude</th>
        <th>DateTime</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>11346</td>
        <td>-17.8349</td>
        <td>28.5346</td>
        <td>26.0</td>
        <td>1.6</td>
        <td>2017-03-09 23:44:06+00:00</td>
      </tr>
      <tr>
        <td>11343</td>
        <td>-17.8459</td>
        <td>28.5491</td>
        <td>27.0</td>
        <td>2.0</td>
        <td>2017-03-10 00:16:10+00:00</td>
      </tr>
      <tr>
        <td>11344</td>
        <td>-17.8863</td>
        <td>28.5008</td>
        <td>20.0</td>
        <td>2.1</td>
        <td>2017-03-10 00:16:11+00:00</td>
      </tr>
      <tr>
        <td>11345</td>
        <td>-17.8657</td>
        <td>28.5204</td>
        <td>30.0</td>
        <td>1.6</td>
        <td>2017-03-10 03:20:26+00:00</td>
      </tr>
      <tr>
        <td>11342</td>
        <td>-17.7156</td>
        <td>28.5985</td>
        <td>0.0</td>
        <td>1.6</td>
        <td>2017-08-21 02:06:55+00:00</td>
      </tr>
    </tbody>
  </table>
</table-wrap>
</sec>
</sec>
<sec id="cca50ca5-nb-1" specific-use="notebook-code">
<preformat>df.describe()</preformat>
<sec id="cca50ca5-output-0-nb-1" specific-use="notebook-output">
<table-wrap>
  <table border="1">
    <thead>
      <tr style="text-align: right;">
        <th></th>
        <th>Longitude</th>
        <th>Latitude</th>
        <th>Depth(km)</th>
        <th>Magnitude</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>count</td>
        <td>11347.000000</td>
        <td>11347.000000</td>
        <td>11347.000000</td>
        <td>11347.000000</td>
      </tr>
      <tr>
        <td>mean</td>
        <td>-17.844062</td>
        <td>28.568893</td>
        <td>14.089345</td>
        <td>2.432423</td>
      </tr>
      <tr>
        <td>std</td>
        <td>0.027345</td>
        <td>0.021899</td>
        <td>8.624787</td>
        <td>0.705282</td>
      </tr>
      <tr>
        <td>min</td>
        <td>-17.995800</td>
        <td>28.310200</td>
        <td>0.000000</td>
        <td>0.200000</td>
      </tr>
      <tr>
        <td>25%</td>
        <td>-17.854100</td>
        <td>28.558000</td>
        <td>10.100000</td>
        <td>1.900000</td>
      </tr>
      <tr>
        <td>50%</td>
        <td>-17.838700</td>
        <td>28.564000</td>
        <td>11.300000</td>
        <td>2.600000</td>
      </tr>
      <tr>
        <td>75%</td>
        <td>-17.829700</td>
        <td>28.574300</td>
        <td>13.900000</td>
        <td>2.900000</td>
      </tr>
      <tr>
        <td>max</td>
        <td>-17.705700</td>
        <td>28.697800</td>
        <td>46.900000</td>
        <td>5.100000</td>
      </tr>
    </tbody>
  </table>
</table-wrap>
</sec>
</sec>
<sec id="cell-3f3b8176-nb-1" specific-use="notebook-code">
<preformat>df.plot.scatter(x=&quot;Longitude&quot;, y=&quot;Latitude&quot;, figsize=(12,12), grid=&quot;on&quot;);</preformat>
<sec id="cell-3f3b8176-output-0-nb-1" specific-use="notebook-output">
<graphic mimetype="image" mime-subtype="png" xlink:href="data-screening_files/figure-jats/cell-5-output-1.png" />
</sec>
</sec>
<sec id="cell-319030b4-nb-1" specific-use="notebook-content">
<sec id="filter-nb-1">
  <title>Filter</title>
  <p>Also some rows seem to be missing depth measurements, (see
  differences in the <bold>count</bold> for columns above) - take only
  rows with valid depths</p>
  </sec>
  <sec id="f02e8517-nb-1" specific-use="notebook-code">
  <preformat>df = df[df['Depth(km)'].notna()]
df.describe()</preformat>
  <sec id="f02e8517-output-0-nb-1" specific-use="notebook-output">
  <table-wrap>
    <table border="1">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>Longitude</th>
          <th>Latitude</th>
          <th>Depth(km)</th>
          <th>Magnitude</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>count</td>
          <td>11347.000000</td>
          <td>11347.000000</td>
          <td>11347.000000</td>
          <td>11347.000000</td>
        </tr>
        <tr>
          <td>mean</td>
          <td>-17.844062</td>
          <td>28.568893</td>
          <td>14.089345</td>
          <td>2.432423</td>
        </tr>
        <tr>
          <td>std</td>
          <td>0.027345</td>
          <td>0.021899</td>
          <td>8.624787</td>
          <td>0.705282</td>
        </tr>
        <tr>
          <td>min</td>
          <td>-17.995800</td>
          <td>28.310200</td>
          <td>0.000000</td>
          <td>0.200000</td>
        </tr>
        <tr>
          <td>25%</td>
          <td>-17.854100</td>
          <td>28.558000</td>
          <td>10.100000</td>
          <td>1.900000</td>
        </tr>
        <tr>
          <td>50%</td>
          <td>-17.838700</td>
          <td>28.564000</td>
          <td>11.300000</td>
          <td>2.600000</td>
        </tr>
        <tr>
          <td>75%</td>
          <td>-17.829700</td>
          <td>28.574300</td>
          <td>13.900000</td>
          <td>2.900000</td>
        </tr>
        <tr>
          <td>max</td>
          <td>-17.705700</td>
          <td>28.697800</td>
          <td>46.900000</td>
          <td>5.100000</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  </sec>
  </sec>
  <sec id="f31daa87-nb-1" specific-use="notebook-code">
  <preformat>plt.figure(figsize=(20,6))
plt.subplot(1,3,1)
df[&quot;Latitude&quot;].plot.hist(bins=20, density=True)
plt.subplot(1,3,2)
df[&quot;Longitude&quot;].plot.hist(bins=20, density=True)
plt.subplot(1,3,3)
df[&quot;Depth(km)&quot;].plot.hist(bins=50, density=True)</preformat>
  <sec id="f31daa87-output-0-nb-1" specific-use="notebook-output">
  <preformat>&lt;Axes: ylabel='Frequency'&gt;</preformat>
  </sec>
  <sec id="f31daa87-output-1-nb-1" specific-use="notebook-output">
  <graphic mimetype="image" mime-subtype="png" xlink:href="data-screening_files/figure-jats/cell-7-output-2.png" />
  </sec>
  </sec>
  <sec id="cell-2e9530fb-nb-1" specific-use="notebook-content">
</sec>
<sec id="spatial-plot-nb-1">
  <title>Spatial Plot</title>
  <p>Scatter plot the spatial locations of events</p>
  </sec>
  <sec id="cell-fig-spatial-plot-nb-1" specific-use="notebook-code">
  <preformat>#| label: fig-spatial-plot
#| fig-cap: Locations of earthquakes on La Palma since 2017.
#| fig-alt: A scatterplot of earthquake locations plotting latitude against longitude.
from matplotlib import colormaps
cmap = colormaps['viridis_r']
ax = df.plot.scatter(x=&quot;Longitude&quot;, y=&quot;Latitude&quot;, 
                     s=47-df[&quot;Depth(km)&quot;], c=df[&quot;Magnitude&quot;], 
                     figsize=(12,10), grid=&quot;on&quot;, cmap=cmap)
colorbar = ax.collections[0].colorbar
colorbar.set_label(&quot;Magnitude&quot;)

plt.show()</preformat>
  <sec id="cell-fig-spatial-plot-output-0-nb-1" specific-use="notebook-output">
  <fig id="fig-spatial-plot-nb-1">
    <caption><p>Locations of earthquakes on La Palma since
    2017.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="data-screening_files/figure-jats/fig-spatial-plot-output-1.png" />
  </fig>
  </sec>
  </sec>
  <sec id="f0aaa739-nb-1" specific-use="notebook-content">
  <sec id="timeline-plot-nb-1">
    <title>Timeline Plot</title>
    <p>Scatter plot the event time series and look for any quantization
    issues. Have times &amp; dates been loaded correctly?</p>
    <p>ax = df.plot.scatter(x=‘DateTime’, y=‘Depth(km)’, figsize=(20,8))
    ax.set_ylim(50,0);</p>
    </sec>
  </sec>
</sec>
</body>



<back>
</back>


</sub-article>

</article>